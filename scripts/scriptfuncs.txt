//----- Variables -----------------------------------------------------------------------------------------------------

eventNum = 1



//----- Broadcast received events -------------------------------------------------------------------------------------

WhenBroadcastReceived(ScriptFunctions::ScriptFunctions)
{
    Call //TODO("ScriptFunctions::ScriptFunctions");
}

WhenBroadcastReceived(ScriptFunctions::setupExternalsTable)
{
    List.DeleteAll(ScriptFuncs::_externalFuncs);
    List.Add(ScriptFuncs::_externalFuncs, "sfSystemCall");
    List.Add(ScriptFuncs::_externalFuncs, "sfInitGraf");
    List.Add(ScriptFuncs::_externalFuncs, "sfRestoreGraf");
    List.Add(ScriptFuncs::_externalFuncs, "sfDrawPicture");
    List.Add(ScriptFuncs::_externalFuncs, "sfClearScreen");
    List.Add(ScriptFuncs::_externalFuncs, "sfShowPage");
    List.Add(ScriptFuncs::_externalFuncs, "sfPollEvent");
    List.Add(ScriptFuncs::_externalFuncs, "sfGetMouseX");
    List.Add(ScriptFuncs::_externalFuncs, "sfGetMouseY");
    List.Add(ScriptFuncs::_externalFuncs, "sfGetKey");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetVisualEffect");
    List.Add(ScriptFuncs::_externalFuncs, "sfPlaySound");
    List.Add(ScriptFuncs::_externalFuncs, "sfPlayMusic");
    List.Add(ScriptFuncs::_externalFuncs, "sfStopMusic");
    List.Add(ScriptFuncs::_externalFuncs, "sfIsMusicPlaying");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetTextPos");
    List.Add(ScriptFuncs::_externalFuncs, "sfFlashScreen");
    List.Add(ScriptFuncs::_externalFuncs, "sfPlayNote");
    List.Add(ScriptFuncs::_externalFuncs, "sfStopNote");
    List.Add(ScriptFuncs::_externalFuncs, "sfPlayTele");
    List.Add(ScriptFuncs::_externalFuncs, "sfStopTele");
    List.Add(ScriptFuncs::_externalFuncs, "sfHideMouseCursor");
    List.Add(ScriptFuncs::_externalFuncs, "sfShowMouseCursor");
    List.Add(ScriptFuncs::_externalFuncs, "sfGetMusicBeat");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetScreenLock");
    List.Add(ScriptFuncs::_externalFuncs, "sfAddSprite");
    List.Add(ScriptFuncs::_externalFuncs, "sfFreeAnim");
    List.Add(ScriptFuncs::_externalFuncs, "sfDrawSprite");
    List.Add(ScriptFuncs::_externalFuncs, "sfEraseSprites");
    List.Add(ScriptFuncs::_externalFuncs, "sfUpdateSprites");
    List.Add(ScriptFuncs::_externalFuncs, "sfGetTimer");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetTimer");
    List.Add(ScriptFuncs::_externalFuncs, "sfResetTimer");
    List.Add(ScriptFuncs::_externalFuncs, "sfAllocTimer");
    List.Add(ScriptFuncs::_externalFuncs, "sfFreeTimer");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetPaletteLock");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetFont");
    List.Add(ScriptFuncs::_externalFuncs, "sfDrawText");
    List.Add(ScriptFuncs::_externalFuncs, "sfHomeText");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetTextRect");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetTextXY");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetFontDropShadow");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetFontColor");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetFontOutline");
    List.Add(ScriptFuncs::_externalFuncs, "sfLoadMouseCursor");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetSpriteGround");
    List.Add(ScriptFuncs::_externalFuncs, "sfLoadResText");
    List.Add(ScriptFuncs::_externalFuncs, "sfAddScreenMask");
    List.Add(ScriptFuncs::_externalFuncs, "sfSetSpriteMask");
    List.Add(ScriptFuncs::_externalFuncs, "sfSoundPlaying");
    List.Add(ScriptFuncs::_externalFuncs, "sfStopSound");
    List.Add(ScriptFuncs::_externalFuncs, "sfPlayVoice");
    List.Add(ScriptFuncs::_externalFuncs, "sfPlayCd");
    List.Add(ScriptFuncs::_externalFuncs, "sfStopCd");
    List.Add(ScriptFuncs::_externalFuncs, "sfGetCdStatus");
    List.Add(ScriptFuncs::_externalFuncs, "sfGetCdTime");
    List.Add(ScriptFuncs::_externalFuncs, "sfPlayCdSegment");
}

WhenBroadcastReceived(sfAddScreenMask)
{
    Call Not implemented yet("AddScreenMask");
}

WhenBroadcastReceived(sfAddSprite)
{
    Call Not implemented yet("AddSprite");
}

WhenBroadcastReceived(sfAllocTimer)
{
    Call Not implemented yet("AllocTimer");
}

WhenBroadcastReceived(sfAnimText)
{
    Call Not implemented yet("AnimText");
}

WhenBroadcastReceived(sfClearMono)
{
    Call Not implemented yet("ClearMono");
}

WhenBroadcastReceived(sfClearScreen)
{
    Call //TODO (quietly)("a few bits and bobs should happen in here");
    List.Add(Gfx.queue, Sensing.Of(command.clearScr, gfx));
    ReturnValue = 0;
}

WhenBroadcastReceived(sfClearText)
{
    Call Not implemented yet("ClearText");
}

WhenBroadcastReceived(sfDeleteChannel)
{
    Call Not implemented yet("DeleteChannel");
}

WhenBroadcastReceived(sfDrawAnimPic)
{
    Call Not implemented yet("DrawAnimPic");
}

WhenBroadcastReceived(sfDrawMenu)
{
    Call Not implemented yet("DrawMenu");
}

WhenBroadcastReceived(sfDrawPicture)
{
    List.Add(Gfx.queue, Sensing.Of(command.drawPic, gfx));
    List.Add(Gfx.queue, argv[5]);
    List.Add(Gfx.queue, argv[4]);
    List.Add(Gfx.queue, argv[3]);
    List.Add(Gfx.queue, argv[2]);
    List.Add(Gfx.queue, argv[1]);
    ReturnValue = 0;
}

WhenBroadcastReceived(sfDrawSprite)
{
    Call Not implemented yet("DrawSprite");
}

WhenBroadcastReceived(sfDrawText)
{
    Call Not implemented yet("DrawText");
}

WhenBroadcastReceived(sfEraseSprites)
{
    Call Not implemented yet("EraseSprites");
}

WhenBroadcastReceived(sfFlashScreen)
{
    Call Not implemented yet("FlashScreen");
}

WhenBroadcastReceived(sfFreeAnim)
{
    Call Not implemented yet("FreeAnim");
}

WhenBroadcastReceived(sfFreeTimer)
{
    Call Not implemented yet("FreeTimer");
}

WhenBroadcastReceived(sfGetAnimFrame)
{
    Call Not implemented yet("GetAnimFrame");
}

WhenBroadcastReceived(sfGetAnimFrameCount)
{
    Call Not implemented yet("GetAnimFrameCount");
}

WhenBroadcastReceived(sfGetCdStatus)
{
    Call //TODO("GetCdStatus");
    ReturnValue = 32000;
}

WhenBroadcastReceived(sfGetCdTime)
{
    Call //TODO("GetCdTime");
    ReturnValue = 32000;
}

WhenBroadcastReceived(sfGetChannelState)
{
    Call Not implemented yet("GetChannelState");
}

WhenBroadcastReceived(sfGetChannelType)
{
    Call Not implemented yet("GetChannelType");
}

WhenBroadcastReceived(sfGetGameDescription)
{
    Call Not implemented yet("GetGameDescription");
}

WhenBroadcastReceived(sfGetKey)
{
    ReturnValue = Sensing.Of(_eventKey, made);
}

WhenBroadcastReceived(sfGetMenuCount)
{
    Call Not implemented yet("GetMenuCount");
}

WhenBroadcastReceived(sfGetMouseX)
{
    ReturnValue = Sensing.Of(_eventMouseX, made);
}

WhenBroadcastReceived(sfGetMouseY)
{
    ReturnValue = Sensing.Of(_eventMouseY, made);
}

WhenBroadcastReceived(sfGetMusicBeat)
{
    Call Not implemented yet("GetMusicBeat");
}

WhenBroadcastReceived(sfGetPictureHeight)
{
    Call Not implemented yet("GetPictureHeight");
}

WhenBroadcastReceived(sfGetPictureWidth)
{
    Call Not implemented yet("GetPictureWidth");
}

WhenBroadcastReceived(sfGetSoundEnergy)
{
    Call Not implemented yet("GetSoundEnergy");
}

WhenBroadcastReceived(sfGetSynthType)
{
    Call Not implemented yet("GetSynthType");
}

WhenBroadcastReceived(sfGetTextWidth)
{
    Call Not implemented yet("GetTextWidth");
}

WhenBroadcastReceived(sfGetTimer)
{
    Call Not implemented yet("GetTimer");
}

WhenBroadcastReceived(sfHideMouseCursor)
{
    Call //TODO("HideMouseCursor");
    ReturnValue = 0;
}

WhenBroadcastReceived(sfHomeText)
{
    Call Not implemented yet("HomeText");
}

WhenBroadcastReceived(sfInitGraf)
{
    ReturnValue = 0;
}

WhenBroadcastReceived(sfIsMusicPlaying)
{
    Call Not implemented yet("IsMusicPlaying");
}

WhenBroadcastReceived(sfIsSlowSystem)
{
    Call Not implemented yet("IsSlowSystem");
}

WhenBroadcastReceived(sfLoadAnim)
{
    Call Not implemented yet("LoadAnim");
}

WhenBroadcastReceived(sfLoadGame)
{
    Call Not implemented yet("LoadGame");
}

WhenBroadcastReceived(sfLoadMouseCursor)
{
    Call Not implemented yet("LoadMouseCursor");
}

WhenBroadcastReceived(sfLoadMusic)
{
    Call Not implemented yet("LoadMusic");
}

WhenBroadcastReceived(sfLoadPicture)
{
    Call Not implemented yet("LoadPicture");
}

WhenBroadcastReceived(sfLoadResText)
{
    Call Not implemented yet("LoadResText");
}

WhenBroadcastReceived(sfLoadSound)
{
    Call Not implemented yet("LoadSound");
}

WhenBroadcastReceived(sfPlaceAnim)
{
    Call Not implemented yet("PlaceAnim");
}

WhenBroadcastReceived(sfPlaceMenu)
{
    Call Not implemented yet("PlaceMenu");
}

WhenBroadcastReceived(sfPlaceSprite)
{
    Call Not implemented yet("PlaceSprite");
}

WhenBroadcastReceived(sfPlaceText)
{
    Call Not implemented yet("PlaceText");
}

WhenBroadcastReceived(sfPlayCd)
{
    Call //TODO("PlayCD");
    ReturnValue = 0;
}

WhenBroadcastReceived(sfPlayCdSegment)
{
    Call Not implemented yet("PlayCdSegment");
}

WhenBroadcastReceived(sfPlayMovie)
{
    Call Not implemented yet("PlayMovie");
}

WhenBroadcastReceived(sfPlayMusic)
{
    Call Not implemented yet("PlayMusic");
}

WhenBroadcastReceived(sfPlayNote)
{
    Call Not implemented yet("PlayNote");
}

WhenBroadcastReceived(sfPlaySound)
{
    If (argc == 1)
    {
        BroadcastParam1 = argv[1];
    }
    Else
    {
        BroadcastParam1 = argv[2];
    }
    Event.BroadcastAndWait("sfx play");
    Call //TODO (quietly)("Various stop and autoStop stuff to add");
    ReturnValue = 0;
}

WhenBroadcastReceived(sfPlayTele)
{
    Call Not implemented yet("PlayTele");
}

WhenBroadcastReceived(sfPlayVoice)
{
    Call Not implemented yet("PlayVoice");
}

WhenBroadcastReceived(sfPollEvent)
{
    Event.BroadcastAndWait("MadeEngine::handleEvents");
    eventNum = _eventNum;
    _eventNum = 0;
    ReturnValue = eventNum;
}

WhenBroadcastReceived(sfPrintf)
{
    Call Not implemented yet("Printf");
}

WhenBroadcastReceived(sfReadMenu)
{
    Call Not implemented yet("ReadMenu");
}

WhenBroadcastReceived(sfReadText)
{
    Call Not implemented yet("ReadText");
}

WhenBroadcastReceived(sfResetTimer)
{
    Call Not implemented yet("ResetTimer");
}

WhenBroadcastReceived(sfRestartEvents)
{
    Call Not implemented yet("RestartEvents");
}

WhenBroadcastReceived(sfRestoreGraf)
{
    ReturnValue = 0;
}

WhenBroadcastReceived(sfSaveGame)
{
    Call Not implemented yet("SaveGame");
}

WhenBroadcastReceived(sfSetAnimFrame)
{
    Call Not implemented yet("SetAnimFrame");
}

WhenBroadcastReceived(sfSetChannelContent)
{
    Call Not implemented yet("SetChannelContent");
}

WhenBroadcastReceived(sfSetChannelLocation)
{
    Call Not implemented yet("SetChannelLocation");
}

WhenBroadcastReceived(sfSetChannelState)
{
    Call Not implemented yet("SetChannelState");
}

WhenBroadcastReceived(sfSetClipArea)
{
    Call Not implemented yet("SetClipArea");
}

WhenBroadcastReceived(sfSetExcludeArea)
{
    Call Not implemented yet("SetExcludeArea");
}

WhenBroadcastReceived(sfSetFont)
{
    Call Not implemented yet("SetFont");
}

WhenBroadcastReceived(sfSetFontColor)
{
    Call Not implemented yet("SetFontColour");
}

WhenBroadcastReceived(sfSetFontDropShadow)
{
    Call Not implemented yet("SetFontDropShadow");
}

WhenBroadcastReceived(sfSetFontOutline)
{
    Call Not implemented yet("SetFontOutline");
}

WhenBroadcastReceived(sfSetMusicVolume)
{
    Call Not implemented yet("SetMusicVolume");
}

WhenBroadcastReceived(sfSetPaletteLock)
{
    Call Not implemented yet("SetPaletteLock");
}

WhenBroadcastReceived(sfSetScreenLock)
{
    Call //TODO("SetScreenLock");
    ReturnValue = 0;
}

WhenBroadcastReceived(sfSetSoundRate)
{
    Call Not implemented yet("SetSoundRate");
}

WhenBroadcastReceived(sfSetSoundVolume)
{
    Call Not implemented yet("SetSoundVolume");
}

WhenBroadcastReceived(sfSetSpriteClip)
{
    Call Not implemented yet("SetSpriteClip");
}

WhenBroadcastReceived(sfSetSpriteExclude)
{
    Call Not implemented yet("SetSpriteExclude");
}

WhenBroadcastReceived(sfSetSpriteGround)
{
    Call Not implemented yet("SetSpriteGound");
}

WhenBroadcastReceived(sfSetSpriteMask)
{
    Call Not implemented yet("SetSpriteMask");
}

WhenBroadcastReceived(sfSetTextPos)
{
    Call Not implemented yet("SetTextPos");
}

WhenBroadcastReceived(sfSetTextRect)
{
    Call Not implemented yet("SetTextRect");
}

WhenBroadcastReceived(sfSetTextXY)
{
    Call Not implemented yet("SetTextXY");
}

WhenBroadcastReceived(sfSetTimer)
{
    Call Not implemented yet("SetTimer");
}

WhenBroadcastReceived(sfSetVisualEffect)
{
    Call //TODO("This should do something funky with visual effects");
    ReturnValue = 0;
}

WhenBroadcastReceived(sfShakeScreen)
{
    Call Not implemented yet("ShakeScreen");
}

WhenBroadcastReceived(sfShowMouseCursor)
{
    Call //TODO("ShowMouseCursor");
    ReturnValue = 0;
}

WhenBroadcastReceived(sfShowPage)
{
    Call //TODO (quietly)("Should this set a flag to tell the system to update the graphics (rather than updating each frame if updates are in the queue)?");
    Event.BroadcastAndWait("process graphics queue");
    ReturnValue = 56;
}

WhenBroadcastReceived(sfSoundPlaying)
{
    Call Not implemented yet("SoundPlaying");
}

WhenBroadcastReceived(sfStopCd)
{
    Call //TODO("StopCD");
    ReturnValue = 0;
}

WhenBroadcastReceived(sfStopMusic)
{
    Call Not implemented yet("StopMusic");
}

WhenBroadcastReceived(sfStopNote)
{
    Call Not implemented yet("StopNote");
}

WhenBroadcastReceived(sfStopSound)
{
    Call Not implemented yet("stStopSound");
}

WhenBroadcastReceived(sfStopTele)
{
    Call Not implemented yet("StopTele");
}

WhenBroadcastReceived(sfSystemCall)
{
    ReturnValue = 0;
}

WhenBroadcastReceived(sfSystemCall)
{
    Call Not implemented yet("SystemCall");
}

WhenBroadcastReceived(sfUpdateSprites)
{
    Call Not implemented yet("UpdateSprites");
}

WhenBroadcastReceived(stopSound)
{
    Call Not implemented yet("stopSound");
}


//----- Custom blocks -------------------------------------------------------------------------------------------------

Define //TODO(string comment) (warp=false)
{
    List.Add(DEBUG, comment);
    List.Show(DEBUG);
}

Define //TODO (quietly)(string comment) (warp=false)
{
}

Define Not implemented yet(string function) (warp=false)
{
    List.DeleteAll(DEBUG);
    List.Add(DEBUG, function);
    List.Show(DEBUG);
    Stop(all);
}


//----- Orphaned blocks -----------------------------------------------------------------------------------------------

Call //TODO("")

Call Not implemented yet("StopCd")

Call Not implemented yet("GetCdStatus")


//----- Costumes ------------------------------------------------------------------------------------------------------

costume1.svg


//----- Sounds --------------------------------------------------------------------------------------------------------

pop.wav
